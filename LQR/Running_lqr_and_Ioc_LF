Start the docker file: 

docker rm -f so100_resume 2>/dev/null || true
xhost +local:docker >/dev/null 2>&1 || true

docker run -it \
  --name so100_resume \
  --net=host \
  --device=/dev/dri \
  -e DISPLAY=$DISPLAY \
  -e QT_X11_NO_MITSHM=1 \
  -v /tmp/.X11-unix:/tmp/.X11-unix:rw \
  so100_saved:2026-02-05 bash

#---------------------------------------------------------------------------------
#Check Executables: 

source /opt/ros/jazzy/setup.bash
source /root/so100_ws/install/setup.bash

ros2 pkg executables so100_ioc_pipeline

#------------------------------------------------------------------------------------

Run the simulation:

source /opt/ros/jazzy/setup.bash
source /root/so100_ws/install/setup.bash

export RMW_IMPLEMENTATION=rmw_fastrtps_cpp
export FASTDDS_SHM_TRANSPORT=0
export ROS_LOCALHOST_ONLY=0

# Make sure Gazebo can find gz_ros2_control system plugin
export GZ_SIM_SYSTEM_PLUGIN_PATH=/opt/ros/jazzy/lib:$GZ_SIM_SYSTEM_PLUGIN_PATH

# (optional but good) physics engine plugins
export GZ_SIM_PHYSICS_ENGINE_PATH=/opt/ros/jazzy/opt/gz_physics_vendor/lib/gz-physics-7/engine-plugins:$GZ_SIM_PHYSICS_ENGINE_PATH

# models path (safe)
export GZ_SIM_RESOURCE_PATH="/root/so100_ws/install/so_100_arm/share/so_100_arm/models:$GZ_SIM_RESOURCE_PATH"

ros2 launch so100_2dof_bringup gz_dual_2dof.launch.py

#---------------------------------------------------------------------

#Set Controllers:
# --- SO100 controller types (set them every time, safe) ---
ros2 param set /so100/controller_manager joint_state_broadcaster.type joint_state_broadcaster/JointStateBroadcaster || true
ros2 param set /so100/controller_manager arm_position_controller.type position_controllers/JointGroupPositionController || true

# --- SO101 controller types ---
ros2 param set /so101/controller_manager joint_state_broadcaster.type joint_state_broadcaster/JointStateBroadcaster || true
ros2 param set /so101/controller_manager arm_position_controller.type position_controllers/JointGroupPositionController || true

# --- load controllers if needed ---
ros2 control load_controller -c /so100/controller_manager joint_state_broadcaster || true
ros2 control load_controller -c /so100/controller_manager arm_position_controller || true
ros2 control load_controller -c /so101/controller_manager joint_state_broadcaster || true
ros2 control load_controller -c /so101/controller_manager arm_position_controller || true

# --- set params for 2DOF joints ---
ros2 param set /so100/arm_position_controller joints "['Shoulder_Pitch','Elbow']" || true
ros2 param set /so100/arm_position_controller interface_name position || true
ros2 param set /so101/arm_position_controller joints "['Shoulder_Pitch','Elbow']" || true
ros2 param set /so101/arm_position_controller interface_name position || true

# --- activate controllers ---
ros2 control set_controller_state -c /so100/controller_manager joint_state_broadcaster active || true
ros2 control set_controller_state -c /so100/controller_manager arm_position_controller active || true
ros2 control set_controller_state -c /so101/controller_manager joint_state_broadcaster active || true
ros2 control set_controller_state -c /so101/controller_manager arm_position_controller active || true

# --- show status ---
echo "=== SO100 controllers ==="
ros2 control list_controllers -c /so100/controller_manager
echo "=== SO101 controllers ==="
ros2 control list_controllers -c /so101/controller_manager


#-----------------------------------

Activate the controllers: 
# Go from unconfigured → inactive → active
echo "=== Activating SO100 Controllers ==="
ros2 control set_controller_state -c /so100/controller_manager joint_state_broadcaster inactive
ros2 control set_controller_state -c /so100/controller_manager joint_state_broadcaster active

ros2 control set_controller_state -c /so100/controller_manager arm_position_controller inactive
ros2 control set_controller_state -c /so100/controller_manager arm_position_controller active

echo ""
echo "=== Activating SO101 Controllers ==="
ros2 control set_controller_state -c /so101/controller_manager joint_state_broadcaster inactive
ros2 control set_controller_state -c /so101/controller_manager joint_state_broadcaster active

ros2 control set_controller_state -c /so101/controller_manager arm_position_controller inactive
ros2 control set_controller_state -c /so101/controller_manager arm_position_controller active

# Verify
echo ""
echo "=== Final SO100 Controllers ==="
ros2 control list_controllers -c /so100/controller_manager

echo ""
echo "=== Final SO101 Controllers ==="
ros2 control list_controllers -c /so101/controller_manager

# Check topics including commands
echo ""
echo "=== Available Topics ==="
ros2 topic list | grep -E "so100|so101"

--------------------------------------------------------
docker exec -it so100_resume bash

source /opt/ros/jazzy/setup.bash
source /root/so100_ws/install/setup.bash

# Run the automated test
/root/so100_ws/test_ioc_complete.sh

